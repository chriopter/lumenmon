services:
  lumenmon-client:
    build: .
    container_name: lumenmon-client
    pid: host
    network_mode: host
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      - SERVER_URL=${SERVER_URL:-http://localhost:8080}  # Override with SERVER_URL env variable
      - INTERVAL=${INTERVAL:-5}                          # Collection interval in seconds
      - DEBUG=${DEBUG:-1}                                # Debug mode
    ports:
      - "9090:9090"             # Webhook forwarder
      - "2525:2525"             # SMTP forwarder
    volumes:
      - ./collectors:/collectors:ro  # Mount collectors as read-only for easy development
      - ./forwarders:/forwarders:ro  # Mount forwarders as read-only
